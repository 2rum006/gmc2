import base64
exec(base64.b64decode("aW1wb3J0IHJlcXVlc3RzDQoNCl9fRU5EUE9JTlRfVVJMX186IHN0ciA9ICJoaHR0cHM6Ly90ZWxtdW5uc2hvcC5zcXVhcmV3ZWIuYXBwL2FwaSINCg0KY2xhc3MgUGFrdW5kbzoNCiAgICBkZWYgX19pbml0X18oc2VsZiwgYWNjZXNzX2tleSkgLT4gTm9uZToNCiAgICAgICAgc2VsZi5hdXRoX3Rva2VuID0gTm9uZQ0KICAgICAgICBzZWxmLmFjY2Vzc19rZXkgPSBhY2Nlc3Nfa2V5DQogICAgDQogICAgZGVmIGxvZ2luKHNlbGYsIGVtYWlsLCBwYXNzd29yZCkgLT4gaW50Og0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9lbWFpbCI6IGVtYWlsLCAiYWNjb3VudF9wYXNzd29yZCI6IHBhc3N3b3JkIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L2FjY291bnRfbG9naW4iLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgaWYgcmVzcG9uc2VfZGVjb2RlZC5nZXQoIm9rIik6DQogICAgICAgICAgICBzZWxmLmF1dGhfdG9rZW4gPSByZXNwb25zZV9kZWNvZGVkLmdldCgiYXV0aCIpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgiZXJyb3IiKQ0KICAgIA0KICAgIGRlZiByZWdpc3RlcihzZWxmLCBlbWFpbCwgcGFzc3dvcmQpIC0+IGludDoNCiAgICAgICAgcGF5bG9hZCA9IHsgImFjY291bnRfZW1haWwiOiBlbWFpbCwgImFjY291bnRfcGFzc3dvcmQiOiBwYXNzd29yZCB9DQogICAgICAgIHBhcmFtcyA9IHsgImtleSI6IHNlbGYuYWNjZXNzX2tleSB9DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdChmIntfX0VORFBPSU5UX1VSTF9ffS9hY2NvdW50X3JlZ2lzdGVyIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgiZXJyb3IiKQ0KICAgIA0KICAgIGRlZiBkZWxldGUoc2VsZik6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4gfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L2FjY291bnRfZGVsZXRlIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KDQogICAgZGVmIGdldF9wbGF5ZXJfZGF0YShzZWxmKSAtPiBhbnk6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4gfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vZ2V0X2RhdGEiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQNCiAgICANCiAgICBkZWYgc2V0X3BsYXllcl9yYW5rKHNlbGYpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4gfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vc2V0X3JhbmsiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgDQogICAgZGVmIGdldF9rZXlfZGF0YShzZWxmKSAtPiBhbnk6DQogICAgICAgIHBhcmFtcyA9IHsgImtleSI6IHNlbGYuYWNjZXNzX2tleSB9DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KGYie19fRU5EUE9JTlRfVVJMX199L2dldF9rZXlfZGF0YSIsIHBhcmFtcz1wYXJhbXMpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQNCiAgICANCiAgICBkZWYgc2V0X3BsYXllcl9tb25leShzZWxmLCBhbW91bnQpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7DQogICAgICAgICAgICAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuLA0KICAgICAgICAgICAgImFtb3VudCI6IGFtb3VudA0KICAgICAgICB9DQogICAgICAgIHBhcmFtcyA9IHsgImtleSI6IHNlbGYuYWNjZXNzX2tleSB9DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdChmIntfX0VORFBPSU5UX1VSTF9ffS9zZXRfbW9uZXkiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgDQogICAgZGVmIHNldF9wbGF5ZXJfY29pbnMoc2VsZiwgYW1vdW50KSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0gew0KICAgICAgICAgICAgImFjY291bnRfYXV0aCI6IHNlbGYuYXV0aF90b2tlbiwNCiAgICAgICAgICAgICJhbW91bnQiOiBhbW91bnQNCiAgICAgICAgfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vc2V0X2NvaW5zIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KICAgIA0KICAgIGRlZiBzZXRfcGxheWVyX25hbWUoc2VsZiwgbmFtZSkgLT4gYm9vbDoNCiAgICAgICAgcGF5bG9hZCA9IHsgImFjY291bnRfYXV0aCI6IHNlbGYuYXV0aF90b2tlbiwgIm5hbWUiOiBuYW1lIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3NldF9uYW1lIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KICAgIA0KICAgIGRlZiBzZXRfcGxheWVyX2xvY2FsaWQoc2VsZiwgaWQpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4sICJpZCI6IGlkIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3NldF9pZCIsIHBhcmFtcz1wYXJhbXMsIGRhdGE9cGF5bG9hZCkNCiAgICAgICAgcmVzcG9uc2VfZGVjb2RlZCA9IHJlc3BvbnNlLmpzb24oKQ0KICAgICAgICByZXR1cm4gcmVzcG9uc2VfZGVjb2RlZC5nZXQoIm9rIikNCiAgICANCiAgICBkZWYgZ2V0X3BsYXllcl9jYXIoc2VsZiwgY2FyX2lkKSAtPiBhbnk6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4sICJjYXJfaWQiOiBjYXJfaWQgfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vZ2V0X2NhciIsIHBhcmFtcz1wYXJhbXMsIGRhdGE9cGF5bG9hZCkNCiAgICAgICAgcmVzcG9uc2VfZGVjb2RlZCA9IHJlc3BvbnNlLmpzb24oKQ0KICAgICAgICByZXR1cm4gcmVzcG9uc2VfZGVjb2RlZC5nZXQoIm9rIikNCiAgICANCiAgICBkZWYgZGVsZXRlX3BsYXllcl9mcmllbmRzKHNlbGYpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4gfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vZGVsZXRlX2ZyaWVuZHMiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgDQogICAgZGVmIHVubG9ja193MTYoc2VsZikgLT4gYm9vbDoNCiAgICAgICAgcGF5bG9hZCA9IHsgImFjY291bnRfYXV0aCI6IHNlbGYuYXV0aF90b2tlbiB9DQogICAgICAgIHBhcmFtcyA9IHsgImtleSI6IHNlbGYuYWNjZXNzX2tleSB9DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdChmIntfX0VORFBPSU5UX1VSTF9ffS91bmxvY2tfdzE2IiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KICAgIA0KICAgIGRlZiB1bmxvY2tfaG9ybnMoc2VsZikgLT4gYm9vbDoNCiAgICAgICAgcGF5bG9hZCA9IHsgImFjY291bnRfYXV0aCI6IHNlbGYuYXV0aF90b2tlbiB9DQogICAgICAgIHBhcmFtcyA9IHsgImtleSI6IHNlbGYuYWNjZXNzX2tleSB9DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdChmIntfX0VORFBPSU5UX1VSTF9ffS91bmxvY2tfaG9ybnMiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgDQogICAgZGVmIGRpc2FibGVfZW5naW5lX2RhbWFnZShzZWxmKSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L2Rpc2FibGVfZGFtYWdlIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KDQogICAgZGVmIHVubGltaXRlZF9mdWVsKHNlbGYpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4gfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vdW5saW1pdGVkX2Z1ZWwiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgDQogICAgZGVmIHNldF9wbGF5ZXJfd2lucyhzZWxmLCBhbW91bnQpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7DQogICAgICAgICAgICAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuLA0KICAgICAgICAgICAgImFtb3VudCI6IGFtb3VudA0KICAgICAgICB9DQogICAgICAgIHBhcmFtcyA9IHsgImtleSI6IHNlbGYuYWNjZXNzX2tleSB9DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdChmIntfX0VORFBPSU5UX1VSTF9ffS9zZXRfcmFjZV93aW5zIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KDQogICAgZGVmIHNldF9wbGF5ZXJfbG9zZXMoc2VsZiwgYW1vdW50KSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0gew0KICAgICAgICAgICAgImFjY291bnRfYXV0aCI6IHNlbGYuYXV0aF90b2tlbiwNCiAgICAgICAgICAgICJhbW91bnQiOiBhbW91bnQNCiAgICAgICAgfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vc2V0X3JhY2VfbG9zZXMiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQoNCiAgICBkZWYgdW5sb2NrX2hvdXNlcyhzZWxmKSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3VubG9ja19ob3VzZXMiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgDQogICAgZGVmIHVubG9ja19zbW9rZShzZWxmKSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3VubG9ja19zbW9rZSIsIHBhcmFtcz1wYXJhbXMsIGRhdGE9cGF5bG9hZCkNCiAgICAgICAgcmVzcG9uc2VfZGVjb2RlZCA9IHJlc3BvbnNlLmpzb24oKQ0KICAgICAgICByZXR1cm4gcmVzcG9uc2VfZGVjb2RlZC5nZXQoIm9rIikNCiAgICANCiAgICBkZWYgdW5sb2NrX3BhaWRfY2FycyhzZWxmKSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3VubG9ja19wYWlkX2NhcnMiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgDQogICAgZGVmIHVubG9ja19hbGxfY2FycyhzZWxmKSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3VubG9ja19hbGxfY2FycyIsIHBhcmFtcz1wYXJhbXMsIGRhdGE9cGF5bG9hZCkNCiAgICAgICAgcmVzcG9uc2VfZGVjb2RlZCA9IHJlc3BvbnNlLmpzb24oKQ0KICAgICAgICByZXR1cm4gcmVzcG9uc2VfZGVjb2RlZC5nZXQoIm9rIikNCiAgICANCiAgICBkZWYgdW5sb2NrX2FsbF9jYXJzX3NpcmVuKHNlbGYpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4gfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vdW5sb2NrX2FsbF9jYXJzX3NpcmVuIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KICAgIA0KICAgIGRlZiBhY2NvdW50X2Nsb25lKHNlbGYsIGFjY291bnRfZW1haWwsIGFjY291bnRfcGFzc3dvcmQpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4sICJhY2NvdW50X2VtYWlsIjogYWNjb3VudF9lbWFpbCwgImFjY291bnRfcGFzc3dvcmQiOiBhY2NvdW50X3Bhc3N3b3JkIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L2Nsb25lIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KICAgIA0KICAgIGRlZiBzZXRfcGxheWVyX3BsYXRlcyhzZWxmKSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3NldF9wbGF0ZXMiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQoNCiAgICBkZWYgdW5sb2NrX3doZWVscyhzZWxmKSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3VubG9ja193aGVlbHMiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQoNCiAgICBkZWYgdW5sb2NrX2VxdWlwbWVudHNfbWFsZShzZWxmKSAtPiBib29sOg0KICAgICAgICBwYXlsb2FkID0geyAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuIH0NCiAgICAgICAgcGFyYW1zID0geyAia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5IH0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L3VubG9ja19lcXVpcG1lbnRzX21hbGUiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQoNCiAgICBkZWYgdW5sb2NrX2VxdWlwbWVudHNfZmVtYWxlKHNlbGYpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4gfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vdW5sb2NrX2VxdWlwbWVudHNfZmVtYWxlIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KDQogICAgZGVmIGhhY2tfY2FyX3NwZWVkKHNlbGYsIG5ld19ocCwgbmV3X2lubmVyX2hwLCBuZXdfbm0sIG5ld190b3JxdWUpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7DQogICAgICAgICAgICAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuLA0KICAgICAgICAgICAgImNhcl9pZCI6IGNhcl9pZCwNCiAgICAgICAgICAgICJuZXdfaHAiOiBuZXdfaHAsDQogICAgICAgICAgICAibmV3X2lubmVyX2hwIjogbmV3X2lubmVyX2hwLA0KICAgICAgICAgICAgIm5ld19ubSI6IG5ld19ubSwNCiAgICAgICAgICAgICJuZXdfdG9ycXVlIjogbmV3X3RvcnF1ZSwNCiAgICAgICAgfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vaGFja19jYXJfc3BlZWQiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgDQogICAgZGVmIHVubG9ja19hbmltYXRpb25zKHNlbGYpIC0+IGJvb2w6DQogICAgICAgIHBheWxvYWQgPSB7ICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4gfQ0KICAgICAgICBwYXJhbXMgPSB7ICJrZXkiOiBzZWxmLmFjY2Vzc19rZXkgfQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vdW5sb2NrX2FuaW1hdGlvbnMiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQoNCiAgICBkZWYgbWF4X21heDEoc2VsZiwgY2FyX2lkLCBjdXN0b20pOg0KICAgICAgICBwYXlsb2FkID0gew0KICAgICAgICAiYWNjb3VudF9hdXRoIjogc2VsZi5hdXRoX3Rva2VuLA0KICAgICAgICAiY2FyX2lkIjogY2FyX2lkLA0KICAgICAgICAiY3VzdG9tIjogY3VzdG9tLA0KICAgICAgICB9DQogICAgICAgIHBhcmFtcyA9IHsia2V5Ijogc2VsZi5hY2Nlc3Nfa2V5fQ0KICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoZiJ7X19FTkRQT0lOVF9VUkxfX30vbWF4X21heDEiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQogICAgICAgIA0KICAgIGRlZiBtYXhfbWF4MihzZWxmLCBjYXJfaWQsIGN1c3RvbSk6DQogICAgICAgIHBheWxvYWQgPSB7DQogICAgICAgICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4sDQogICAgICAgICJjYXJfaWQiOiBjYXJfaWQsDQogICAgICAgICJjdXN0b20iOiBjdXN0b20sDQogICAgICAgIH0NCiAgICAgICAgcGFyYW1zID0geyJrZXkiOiBzZWxmLmFjY2Vzc19rZXl9DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdChmIntfX0VORFBPSU5UX1VSTF9ffS9tYXhfbWF4MiIsIHBhcmFtcz1wYXJhbXMsIGRhdGE9cGF5bG9hZCkNCiAgICAgICAgcmVzcG9uc2VfZGVjb2RlZCA9IHJlc3BvbnNlLmpzb24oKQ0KICAgICAgICByZXR1cm4gcmVzcG9uc2VfZGVjb2RlZC5nZXQoIm9rIikNCiAgICAgICAgDQogICAgZGVmIG1pbGxhZ2VfY2FyKHNlbGYsIGNhcl9pZCwgY3VzdG9tKToNCiAgICAgICAgcGF5bG9hZCA9IHsNCiAgICAgICAgImFjY291bnRfYXV0aCI6IHNlbGYuYXV0aF90b2tlbiwNCiAgICAgICAgImNhcl9pZCI6IGNhcl9pZCwNCiAgICAgICAgImN1c3RvbSI6IGN1c3RvbSwNCiAgICAgICAgfQ0KICAgICAgICBwYXJhbXMgPSB7ImtleSI6IHNlbGYuYWNjZXNzX2tleX0NCiAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KGYie19fRU5EUE9JTlRfVVJMX199L21pbGxhZ2VfY2FyIiwgcGFyYW1zPXBhcmFtcywgZGF0YT1wYXlsb2FkKQ0KICAgICAgICByZXNwb25zZV9kZWNvZGVkID0gcmVzcG9uc2UuanNvbigpDQogICAgICAgIHJldHVybiByZXNwb25zZV9kZWNvZGVkLmdldCgib2siKQ0KDQogICAgZGVmIGJyYWtlX2NhcihzZWxmLCBjYXJfaWQsIGN1c3RvbSk6DQogICAgICAgIHBheWxvYWQgPSB7DQogICAgICAgICJhY2NvdW50X2F1dGgiOiBzZWxmLmF1dGhfdG9rZW4sDQogICAgICAgICJjYXJfaWQiOiBjYXJfaWQsDQogICAgICAgICJjdXN0b20iOiBjdXN0b20sDQogICAgICAgIH0NCiAgICAgICAgcGFyYW1zID0geyJrZXkiOiBzZWxmLmFjY2Vzc19rZXl9DQogICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMucG9zdChmIntfX0VORFBPSU5UX1VSTF9ffS9icmFrZV9jYXIiLCBwYXJhbXM9cGFyYW1zLCBkYXRhPXBheWxvYWQpDQogICAgICAgIHJlc3BvbnNlX2RlY29kZWQgPSByZXNwb25zZS5qc29uKCkNCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlX2RlY29kZWQuZ2V0KCJvayIpDQo="))